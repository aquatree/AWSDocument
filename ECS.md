# ECS

## 構成要素

* タスク
  * タスク定義に基づいて起動するコンテナの集まり
* タスク定義
  * タスクを作成するテンプレート定義
* サービス
  * 実行中のタスクを管理する
* クラスター
  * サービス・タスクを実行する基盤

また、ECSは管理サービスであって、実行環境はEC2またはFargateなどになる

## 設定ファイル

* `/etc/ecs/ecs.config`
* IAMロールを`bridge`か`default`ネットワークモードでオンにする：`ECS_ENABLE_TASK_IAM_ROLE=true`
* IAMロールを`host`ネットワークモードでオンにする：`ECS_ENABLE_TASK_IAM_ROLE_NETWORK_HOST=true`

## タスク配置戦略

* コンテナがどのインスタンスで起動され、スケーリングするときにどのように増減するのか等を決める。以下の三つがある
  * Binpack
    * CPUまたはメモリの最小利用可能量に基づいてタスクを配置。使用するインスタンス数が最小になる
  * Random
    * タスクをランダムに配置する
  * Spread
    * EC2インスタンスのID、またはアベイラビリティゾーンなどを指定すると、それごとに均等に配置する
